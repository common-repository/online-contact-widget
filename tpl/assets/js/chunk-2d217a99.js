(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d217a99"],{c84b:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wbs-content content-cd wp-contact-detail"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"wbs-content-inner",class:{"wb-page-loaded":t.isLoaded}},[a("div",{staticClass:"cd-wp"},[a("div",{staticClass:"wb-header"},[a("div",{domProps:{innerHTML:t._s(t.getStatus(t.row))}}),a("div",{staticClass:"wb-main-title"},[a("span",[t._v("["+t._s(t.getType(t.row["type"]))+"]")]),a("strong",{staticClass:"ml"},[t._v(t._s(t.row["title"]))])]),t.row["name"]?a("p",{staticClass:"meta-item"},[a("span",[t._v("联系人: "+t._s(t.row["name"]))])]):t._e(),t.row["email"]?a("p",{staticClass:"meta-item"},[a("span",[t._v("邮箱: "+t._s(t.row["email"]))])]):t._e(),t.row["mobile"]?a("p",{staticClass:"meta-item"},[a("span",[t._v("电话: "+t._s(t.row["mobile"]))])]):t._e(),t.row["qq"]?a("p",{staticClass:"meta-item"},[a("span",[t._v("QQ: "+t._s(t.row["qq"]))])]):t._e(),t.row["wx"]?a("p",{staticClass:"meta-item"},[a("span",[t._v("微信: "+t._s(t.row["wx"]))])]):t._e(),a("p",{staticClass:"meta-item"},[a("span",[t._v("发起时间: "+t._s(t.row["create_date"]))]),t.row["update_time"]?a("span",{staticClass:"ml-l"},[t._v("更新时间: "+t._s(t.row["update_time"]))]):t._e()]),a("div",{staticClass:"hd-ctrl-area"},[1==t.row["status"]?a("el-button",{attrs:{title:"关闭工单",icon:"el-icon-close",circle:""},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.doClose(t.row.id)}}}):t._e(),a("el-button",{attrs:{title:"返回列表",type:"primary",icon:"el-icon-back",circle:""},on:{click:t.backList}})],1)]),a("div",{staticClass:"rec-content-box cd-main"},[a("ul",t._l(t.list,(function(e,s){return a("li",{key:"item"+s,staticClass:"rec-detail ",class:s>0?"by-me":"by-wb"},[a("div",{staticClass:"msg-hd"},[a("div",{staticClass:"user-name"},[a("strong",[t._v(t._s(s>0?e["display_name"]+"备注:":"留言内容:"))]),a("span",{staticClass:"wk"},[t._v(t._s(e["create_date"]))])])]),a("div",{staticClass:"msg-detail"},[a("div",{domProps:{innerHTML:t._s(e["content"])}})])])})),0)]),a("div",{staticClass:"reply-box"},[a("el-input",{attrs:{clearable:"",type:"textarea",autosize:{minRows:1,maxRows:3},placeholder:"请输入备注"},model:{value:t.newReply.content,callback:function(e){t.$set(t.newReply,"content",e)},expression:"newReply.content"}}),a("div",{staticClass:"rb-ft"},[a("el-button",{staticClass:"ml",attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.reply()}}},[t._v("添加备注")])],1),a("div",{staticClass:"rb-ft"},[2!=t.row.status?a("el-link",{staticClass:"ml",attrs:{size:"mini",plain:""},on:{click:function(e){return t.doClose(t.row.id)}}},[t._v("关闭")]):t._e(),a("el-link",{staticClass:"ml",attrs:{plain:"",size:"mini",type:"danger"},on:{click:function(e){return t.doRemove(t.row.id)}}},[t._v("删除")]),1==t.row.status?a("el-button",{staticClass:"ml",attrs:{type:"success"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.setProcessed.apply(null,arguments)}}},[t._v("标记为已处理")]):t._e()],1)],1)])])])},n=[],i={name:"ContactDetail",data(){return{formChanged:0,isLoaded:0,loading:null,cnf:{},row:{},list:[],newReply:{content:""},fileObj:null,uploadStatus:" ",isSelectFile:!1,files:[],remark:"",isMobile:!1}},inject:["reload"],created(){this.loading=this.$wbui.loading(),this._getData(),this.isMobile=/mobile/i.test(navigator.userAgent)},methods:{_getData(){const t=this,e=t.$route.query.id;t.$api.getData({_ajax_nonce:t.$cnf._ajax_nonce,action:"ocw_contact",op:"get_detail",id:e}).then(e=>{t.row=e["row"],t.list=e["list"],t.cnf=e["cnf"],t.isLoaded=1,t.$wbui.close(t.loading)})},backList(){this.$router.push({path:"/wo-list"})},getStatus(t){return 2==t.status?'<span class="wb-status-tag done">已关闭</span>':1==t.is_new?'<span class="wb-status-tag new">待处理</span>':3==t.status?'<span class="wb-status-tag success">已处理</span>':"-"},setProcessed(){const t=this;t.$wbui.confirm("确认标记为已处理？",()=>{const e={_ajax_nonce:t.$cnf._ajax_nonce,action:"ocw_contact",op:"processed",id:t.row.id};t.$api.saveData(e).then(e=>{t.$wbui.toast("已标记"),t.reload()})})},doClose(t){const e=this;e.$wbui.confirm("确认关闭？",()=>{const a={_ajax_nonce:e.$cnf._ajax_nonce,action:"ocw_contact",op:"set_close",id:t};e.$api.saveData(a).then(t=>{e.$wbui.toast("已关闭"),e._getData()})})},doRemove(t){const e=this;e.$wbui.confirm("删除后将无法恢复，确认删除？",(function(){const a={_ajax_nonce:e.$cnf._ajax_nonce,action:"ocw_contact",op:"delete",id:t};e.$api.saveData(a).then((function(t){e.$wbui.toast("删除成功"),e.backList()}))}))},reply(){const t=this;if(""===t.newReply.content)return t.$wbui.toast("请输入内容再提交"),!1;t.$api.saveData({_ajax_nonce:t.$cnf._ajax_nonce,action:"ocw_contact",op:"reply",id:t.row.id,content:t.newReply.content}).then(e=>{t.reload()})},removeFileItem(t){this.files.splice(t,1)},getType(t){return isNaN(Number(t,10))?t:this.cnf[t]}},beforeRouteLeave(t,e,a){const s=this;s.formChanged>1?s.$wbui.open({content:"您修改的设置尚未保存，确定离开此页面吗？",btn:["保存并离开","放弃修改"],yes(){return a(!1),s.updateData(()=>{a()}),!1},no(){return a(),!1}}):a()}},o=i,c=a("2877"),l=Object(c["a"])(o,s,n,!1,null,null,null);e["default"]=l.exports}}]);